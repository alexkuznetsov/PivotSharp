@page
@model PivotSharp.WebCore.Pages.QueryBuilder.ViewModel
@{
}

<div class="row" style="margin-top: 20px;">
	<partial name="_Chart" model="Model.PivotTableViewModel" />

</div>

<div class="row" style="margin-top: 20px;">
	<div class="col-lg-12 col-md-12 col-sm-12">

		<div class="panel panel-primary">
			<div class="panel-heading">
				@Model.PivotTableViewModel.Config.Aggregators[0].ColumnName
				pivoted by
				@string.Join(",", Model.PivotTableViewModel.Config.Rows)
				and
				@string.Join(",", Model.PivotTableViewModel.Config.Cols)
			</div>
			<div class="panel-body">
				<partial name="_PivotTable" model="Model.PivotTableViewModel" />
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	$(document).ready(function () {
		$(".data-cell").on('click', function () {
			window.open('/QueryBuilder' +
				'/DrillDown/' + @Model.PivotTableViewModel.Id + '?rowKeys=' + $(this).data('row-key') + '&colKeys=' + $(this).data('col-key'), '_blank');
		});
	});
</script>
